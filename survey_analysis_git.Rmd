---
title: "Survey Analysis"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(Hmisc)
library(lubridate)
library(ggplot2)
library(forcats)
library(gridExtra)

survey_combined <- read_csv('survey_combined.csv')
```


```{r, include=FALSE}
# use correct_sum
# survey_cleaned$Adlformdrivealonedays
# survey_cleaned$Adlformtypicalweek

survey_combined <- survey_combined %>% 
  mutate(trip_sum = `jan1-5`+`jan6-12`+`jan13-19`+`jan20-26`+`jan27-feb2`+`feb3-9`+`feb10-16`+`feb17-23`+`feb24-mar1`) 

survey_combined <- survey_combined%>%
  mutate(trip_dummy = if_else(trip_sum > 0, 1, 0))

survey_combined$trip_dummy <- as_factor(survey_combined$trip_dummy)

survey_combined$Adlformtypicalweek <- as_factor(survey_combined$Adlformtypicalweek) %>%
  fct_relevel(c("noIntentionToChange", "dontKnowHowToChange", "consideringChanges",  "newAlternativeSchedule", "veteranAlternativeCommuter")) %>%
    fct_recode('habit1' = "noIntentionToChange", 'habit2' = "dontKnowHowToChange", 'habit3' = "consideringChanges", 'habit4' = "newAlternativeSchedule", 'habit5' = "veteranAlternativeCommuter")

levels(survey_combined$Adlformtypicalweek)
```

```{r, include=FALSE}
p1 <- survey_combined %>%
  ggplot(aes(trip_dummy)) +
  geom_bar() + theme_classic() + xlab('tracking trips')

p2 <- survey_combined %>%
  ggplot(aes(trip_sum)) +
  geom_histogram(binwidth = 50) + theme_classic() + xlab('total trips')

p3 <- survey_combined %>%
  mutate(correct_percent = correct_sum/6) %>% 
  ggplot(aes(as_factor(round(correct_percent, digits = 2)))) +
  geom_bar() + theme_classic() + xlab('percent of correct answers')

p4 <- survey_combined %>%
  ggplot(aes(Adlformdrivealonedays)) +
  geom_bar() + theme_classic() + xlab('days driving alone')

p5 <- survey_combined %>%
  ggplot(aes(as_factor(Adlformcommutesatisfaction))) +
  geom_bar() + theme_classic() + xlab('commute satisfaction scale from 1 to 10')

p6 <- survey_combined %>%
  ggplot(aes(Adlformtypicalweek)) +
  geom_bar() + theme_classic() + xlab('commute habits')
```

### Exploratory graphs

```{r, echo=FALSE}
grid.arrange(p1, p2, p3, p4, p5, p6, nrow = 3, ncol = 2)
```

Commute habit options:

- I drive alone for most of my trips, and don’t intend to make a change.
- I drive alone for most of my trips, and I’m considering changes but don’t know how.
- I drive alone for most of my trips, and I’m considering making changes but haven’t started.
- I already use other ways than driving alone and have been doing so for less than 6 months.
- I already use other ways than driving alone and have been doing so for more than 6 months. 


### OLS

```{r, echo=FALSE}
reg <- lm(trip_sum ~ correct_sum + Adlformcommutesatisfaction + Adlformdrivealonedays + Adlformtypicalweek, data = survey_combined)
summary(reg)
```

### Logistic regression

```{r, echo=FALSE}
logit <- glm(trip_dummy ~ correct_sum + Adlformcommutesatisfaction + Adlformdrivealonedays + Adlformtypicalweek, data = survey_combined, family = 'binomial')
summary(logit)
```
